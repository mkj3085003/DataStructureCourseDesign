<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SocialNetwork Visualization</title>
    <link rel="stylesheet" href="css\SocialNetwork.css">
    <link rel="stylesheet" href="css\title.css">
</head>

<body>

    <div id="app">
        <!-- È°µÈù¢Ê†áÈ¢ò -->
        <div class="top-section">
            <h1 data-shadow='SocialNetwork'>SocialNetwork</h1>

        </div>
        <div class="topright-section">
            <button class="homebutton" v-on:click="redirectToHome"> Back Home </button>
        </div>
        <div class="down-section">
            <!-- È°µÈù¢Â∑¶‰æßÁöÑÂç°Áâá -->
            <div class="left-section">
                <div class="card">
                    <div class="card__content">
                        <!-- ‰ΩøÁî®VueÁöÑÊù°‰ª∂Ê∏≤ÊüìÊù•Ê†πÊçÆÈÄâÈ°πÊòæÁ§∫‰∏çÂêåÁöÑÂÜÖÂÆπ -->
                        <!-- SocialNetwork ÂÜÖÂÆπ -->
                        <div id="chart-container">
                            <!-- Â±ïÁ§∫ÁªìÁÇπ‰ø°ÊÅØÁöÑÊÇ¨ÂÅúÊ°Ü -->
                            <div id="tooltip" class="tooltip" style="display: none;"></div>
                        </div>
                        <div v-if="selectedOption === 'Network'">
                            <!-- ÁªòÂà∂Âõæ‰æã -->
                            <div id="indicator">
                                <div v-for="(item, index) in indicatorItems" :key="index" class="one-indicator">
                                    <div class="color-box" :style="{ background: item.color }"></div>
                                    {{ item.name }}
                                </div>
                            </div>
                        </div>
                        <!-- ÁªìÁÇπÊòØÂê¶Â±ïÁ§∫ÊñáÂ≠óÁöÑÊåâÈíÆ -->
                        <div class="mode" v-if="selectedOption === 'Network'">
                            <div class="container">
                              <div class="tabs">
                                <input type="radio" id="radio-1" name="tabs" checked="">
                                <label class="tab" for="radio-1" @click="NodeTextNoVisibility">Circle</label>
                                <input type="radio" id="radio-2" name="tabs">
                                <label class="tab" for="radio-2" @click="NodeTextVisibility">Text</label>
                                <span class="glider"></span>
                              </div>
                            </div>
                          </div>

                        <!-- NodeTable ÂÜÖÂÆπ -->
                        <div v-if="selectedOption === 'NodeTable'">
                            <!-- NodeTable ÂÜÖÂÆπ -->
                            <!-- ‰ΩøÁî® Element UI Ë°®Ê†ºÁªÑ‰ª∂ -->
                            <!-- ÊêúÁ¥¢Ê°Ü -->
                            <div class="nodeTable-top-section">
                                <input type="text" v-model="searchQuery" name="search" placeholder="Search For Anything.." class="search-input">
                            </div>
                            <!-- Êñá‰ª∂‰∏ä‰º† -->
                            <div class="nodeTable-topright-section">
                                <div class="fileProcess">
                                    <input type="file" id="fileInput" @change="handleFileUpload"
                                        style="display: none;" />
                                    <button class="btn-file" id="btn-upload" @click="openFileInput">
                                        ü°Ö
                                        <div class="hoverEffect">
                                            <div>
                                            </div>
                                        </div>
                                    </button>
                                    <button class="btn-file" id="btn-download" @click="downloadNodeManagerAsJson">
                                        ü°á
                                        <div class="hoverEffect">
                                            <div>
                                            </div>
                                        </div>
                                    </button>
                                </div>
                            </div>
                            <div class="nodeTable-down-section">
                                <!-- ‰∏™‰∫∫ÁªìÁÇπ -->
                                <div class="person-node-list">
                                    <div class="person-node-titie">
                                        <span class="node-title">PersonNode</span>
                                        <button class="btn-insert" @click="showPersonAddForm">
                                            create
                                        </button>
                                    </div>
                                    <div class="person-node-content">
                                        <div v-for="node in nodeManager.nodes" :key="node.id" v-if="node.tag === NodeTag.PERSON && (searchQuery === '' || node.name.toLowerCase().includes(searchQuery))">
                                            <div class="person-node">
                                                <p class="node-name">{{ node.name }}</p>
                                                <i v-if="node.gender === 1" class="el-icon-male"></i>
                                                <i v-else-if="node.gender === 2" class="el-icon-female"></i>
                                                <div class="node-actions">
                                                    <el-button type="primary" icon="el-icon-edit" circle
                                                        class="custom-button" id="edit"
                                                        @click="showEditPersonNodeForm(node.id)"></el-button>
                                                    <el-button type="danger" icon="el-icon-delete" circle
                                                        class="custom-button" id="delete"
                                                        @click="showDeletePersonNodeDialog(node.id)"></el-button>
                                                    <el-button type="success" icon="el-icon-star-off" circle
                                                        class="custom-button" id="star"
                                                        @click="generateRecommendedFriends(node.id)"></el-button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Áæ§ÁªÑÁªìÁÇπ -->
                                <div class="group-node-list">
                                    <div class="group-node-titie">
                                        <span class="node-title">GroupNode</span>
                                        <button class="btn-insert" @click="showGroupAddForm">
                                            create
                                        </button>
                                    </div>
                                    <div class="group-node-content">
                                        <div v-for="node in nodeManager.nodes" :key="node.id" v-if="node.tag !== NodeTag.PERSON && (searchQuery === '' || node.name.toLowerCase().includes(searchQuery))">
                                            <div class="person-node">
                                                <p class="node-name">{{ node.name }}</p>
                                                <div class="node-actions">
                                                    <el-button type="primary" icon="el-icon-edit" circle
                                                        class="custom-button" id="edit"
                                                        @click="showEditGroupNodeForm(node.id)"></el-button>
                                                    <el-button type="danger" icon="el-icon-delete" circle
                                                        class="custom-button" id="delete"
                                                        @click="showDeleteGroupNodeDialog(node.id)"></el-button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- È°µÈù¢ÂàáÊç¢ÁöÑÂØºËà™Ê†è -->
            <div class="right-section">
                <form>
                    <label>
                        <input type="radio" name="radio" v-model="selectedOption" value="Network">
                        <span @click="changeOption('Network')">Network</span>
                    </label>
                    <label>
                        <input type="radio" name="radio" v-model="selectedOption" value="NodeTable">
                        <span @click="changeOption('NodeTable')">NodeTable</span>
                    </label>
                </form>
            </div>
        </div>
        <!-- Ê∑ªÂä†‰∏™‰∫∫ÁªìÁÇπÁöÑË°®Âçï -->
        <div id="person-add-form" v-if="isPersonAddVisible">
            <!-- Ê∑ªÂä†ÂÖ≥Èó≠ÊåâÈíÆ -->
            <button class="close-button" @click="hidePersonAddForm">‚úñ</button>
            <el-form :model="PersonFormData">
                <el-form-item label="ÂßìÂêç">
                    <el-input v-model="PersonFormData.name" class="form-width"></el-input>
                </el-form-item>
                <el-form-item label="ÊÄßÂà´">
                    <el-select v-model="PersonFormData.gender" class="form-width">
                        <el-option label="Áî∑" :value="PersonGender.MALE"></el-option>
                        <el-option label="Â•≥" :value="PersonGender.FEMALE"></el-option>
                        <el-option label="ÂÖ∂‰ªñ" :value="PersonGender.OTHER"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="Áæ§ÁªÑ">
                    <el-select v-model="PersonFormData.groups" multiple class="form-width">
                        <!-- ÈÅçÂéÜÊòæÁ§∫Áæ§ÁªÑÈÄâÈ°π -->
                        <el-option v-for="node in nodeManager.nodes" :key="node.id" :label="node.name" :value="node.id"
                            v-if="node.tag !== NodeTag.PERSON"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="Â•ΩÂèã" class="form-label">
                    <el-select v-model="PersonFormData.friends" multiple class="form-width">
                        <!-- ÈÅçÂéÜÊòæÁ§∫Â•ΩÂèãÈÄâÈ°π -->
                        <el-option v-for="node in nodeManager.nodes" :key="node.id" :label="node.name" :value="node.id"
                            v-if="node.tag === NodeTag.PERSON"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item>
                    <el-button type="primary" @click="addPersonNode" id="btn-submit">Êèê‰∫§</el-button>
                </el-form-item>
            </el-form>
        </div>
        <!-- Ê∑ªÂä†Áæ§ÁªÑÁªìÁÇπÁöÑË°®Âçï -->
        <div id="group-add-form" v-if="isGroupAddVisible">
            <!-- Ê∑ªÂä†ÂÖ≥Èó≠ÊåâÈíÆ -->
            <button class="close-button" @click="hideGroupAddForm">‚úñ</button>
            <el-form :model="GroupFormData">
                <el-form-item label="Áæ§ÁªÑÂêç">
                    <el-input v-model="GroupFormData.name" class="form-width"></el-input>
                </el-form-item>
                <el-form-item label="ÂÖ≥ËÅîÁ≥ªÊï∞">
                    <el-input v-model="GroupFormData.relationCoefficient" class="form-width" type="number"></el-input>
                </el-form-item>
                <el-form-item label="Á±ªÂà´">
                    <el-select v-model="GroupFormData.tag" class="form-width">
                        <el-option label="Â∞èÂ≠¶" :value="NodeTag.PRIMARY_SCHOOL"></el-option>
                        <el-option label="Âàù‰∏≠" :value="NodeTag.JUNIOR_HIGH"></el-option>
                        <el-option label="È´ò‰∏≠" :value="NodeTag.SENIOR_HIGH "></el-option>
                        <el-option label="Â§ßÂ≠¶" :value="NodeTag.UNIVERSITY "></el-option>
                        <el-option label="ÂÖ∂‰ªñ" :value="NodeTag.GROUP"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item>
                    <el-button type="primary" @click="addGroupNode" id="btn-submit">Êèê‰∫§</el-button>
                </el-form-item>
            </el-form>
        </div>
        <!-- ÁºñËæë‰∏™‰∫∫ÁªìÁÇπÁöÑË°®Âçï -->
        <div id="person-edit-form" v-if="isPersonEditVisible">
            <el-form :model="EditedPersonData" class="form-container">
                <el-form-item label="ÂßìÂêç">
                    <el-input v-model="EditedPersonData.name" class="form-width"></el-input>
                </el-form-item>
                <el-form-item label="ÊÄßÂà´">
                    <el-select v-model="EditedPersonData.gender" class="form-width">
                        <el-option label="Áî∑" :value="PersonGender.MALE"></el-option>
                        <el-option label="Â•≥" :value="PersonGender.FEMALE"></el-option>
                        <el-option label="ÂÖ∂‰ªñ" :value="PersonGender.OTHER"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="Áæ§ÁªÑ">
                    <el-select v-model="EditedPersonData.groups" multiple class="form-width">
                        <!-- ÈÅçÂéÜÊòæÁ§∫Áæ§ÁªÑÈÄâÈ°π -->
                        <el-option v-for="node in nodeManager.nodes" :key="node.id" :label="node.name" :value="node.id"
                            v-if="node.tag !== NodeTag.PERSON"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="Â•ΩÂèã" class="form-label">
                    <el-select v-model="EditedPersonData.friends" multiple class="form-width">
                        <!-- ÈÅçÂéÜÊòæÁ§∫Â•ΩÂèãÈÄâÈ°π -->
                        <el-option v-for="node in nodeManager.nodes" :key="node.id" :label="node.name" :value="node.id"
                            v-if="node.tag === NodeTag.PERSON && node.id !== EditedPersonData.id"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item>
                    <el-button type="primary" @click="updatePersonNode" id="btn-edit-save">‰øùÂ≠ò</el-button>
                    <el-button type="primary" @click="hidePersonEditForm" id="btn-edit-cancel">ÂèñÊ∂à</el-button>
                </el-form-item>
            </el-form>
        </div>
        <!-- ÁºñËæëÁæ§ÁªÑÁªìÁÇπÁöÑË°®Âçï -->
        <div id="group-edit-form" v-if="isGroupEditVisible">
            <el-form :model="EditedGroupData" class="form-container">
                <el-form-item label="Áæ§ÁªÑÂêçÁß∞">
                    <el-input v-model="EditedGroupData.name" class="form-width"></el-input>
                </el-form-item>
                <el-form-item label="ÂÖ≥ËÅîÊï∞">
                    <el-input v-model="EditedGroupData.relationCoefficient" class="form-width" type="number"></el-input>
                </el-form-item>
                <el-form-item label="Áæ§ÁªÑÁ±ªÂà´">
                    <el-select v-model="EditedGroupData.tag" class="form-width">
                        <el-option label="Â∞èÂ≠¶" :value="NodeTag.PRIMARY_SCHOOL"></el-option>
                        <el-option label="Âàù‰∏≠" :value="NodeTag.JUNIOR_HIGH"></el-option>
                        <el-option label="È´ò‰∏≠" :value="NodeTag.SENIOR_HIGH "></el-option>
                        <el-option label="Â§ßÂ≠¶" :value="NodeTag.UNIVERSITY "></el-option>
                        <el-option label="ÂÖ∂‰ªñ" :value="NodeTag.GROUP"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item>
                    <el-button type="primary" @click="updateGroupNode" id="btn-edit-save">‰øùÂ≠ò</el-button>
                    <el-button type="primary" @click="hideGroupEditForm" id="btn-edit-cancel">ÂèñÊ∂à</el-button>
                </el-form-item>
            </el-form>
        </div>
        <!-- Âà†Èô§‰∏™‰∫∫ÁªìÁÇπÁöÑÊèêÁ§∫Á™óÂè£ -->
        <div id="person-delete-window" v-if="isDeletePersonNodeDialogVisible">
            <span class="span-delete">Á°ÆËÆ§Âà†Èô§‰∏™‰∫∫ÁªìÁÇπ "{{ deletingPersonNode.name }}" ÂèäÂÖ∂ÊâÄÊúâÂÖ≥Á≥ªÂêóÔºü</span>
            <span class="span-delete-2">Ê≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄÔºåËØ∑Ë∞®ÊÖéÊìç‰Ωú„ÄÇ</span>
            <span slot="footer" class="dialog-footer">
                <el-button @click="deletePersonNode" type="danger" id="btn-confirm">Á°ÆËÆ§</el-button>
                <el-button @click="hideDeletePersonNodeDialog" type="danger" id="btn-cancel">ÂèñÊ∂à</el-button>
            </span>
        </div>
        <!-- Âà†Èô§Áæ§ÁªÑÁªìÁÇπÁöÑÊèêÁ§∫Á™óÂè£ -->
        <div id="group-delete-window" v-if="isDeleteGroupNodeDialogVisible">
            <span class="span-delete">Á°ÆËÆ§Âà†Èô§Áæ§ÁªÑÁªìÁÇπ "{{ deletingGroupNode.name }}" ÂèäÂÖ∂ÊâÄÊúâÂÖ≥Á≥ªÂêóÔºü</span>
            <span class="span-delete-2">Ê≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄÔºåËØ∑Ë∞®ÊÖéÊìç‰Ωú„ÄÇ</span>
            <span slot="footer" class="dialog-footer">
                <el-button @click="deleteGroupNode" type="danger" id="btn-confirm-2">Á°ÆËÆ§</el-button>
                <el-button @click="hideDeleteGroupNodeDialog" type="danger" id="btn-cancel-2">ÂèñÊ∂à</el-button>
            </span>
        </div>
        <!-- Â±ïÁ§∫‰∏™‰∫∫ÁªìÁÇπÊé®ËçêÂ•ΩÂèãÁöÑÁ™óÂè£ -->
        <div id="recommend-friends" v-if="showRecommendFriends">
            <div id="one-recommend-friend" v-for="friend in recommendedFriends" :key="friend.node.id">

                <div class="friend-name">
                    <span class="star-icon"></span>
                    {{ friend.node.name }}
                    <el-button id="btn-add" type="danger" @click="addFriend(friend.node)">Ê∑ªÂä†</el-button>
                </div>
                <div class="friend-content">
                    Êé®ËçêÊåáÊï∞: {{ friend.idx.toFixed(2) }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    ÂÖ±ÂêåÂ•ΩÂèãÊï∞Èáè:{{friend.commonFriends }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    ÂÖ±ÂêåÁæ§ÁªÑÊï∞Èáè:{{friend.commonOrganizations}}
                </div>
            </div>
            <el-button id="btn-close" type="danger" @click="closeRecommendFriends">ÂÖ≥Èó≠</el-button>
        </div>
    </div>


    <!-- ÂºïÂÖ• Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>

    <!-- ÂºïÂÖ•D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- ÂºïÂÖ• Element UI Ê†∑ÂºèÂíåËÑöÊú¨ -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui@2.15.6/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui@2.15.6/lib/index.js"></script>

    <!-- ÂºïÂÖ•Êï∞ÊçÆÁªìÊûÑÈÉ®ÂàÜ -->
    <script src="js/DataStructure/NodeBase.js"></script>
    <script src="js/DataStructure/GroupNode.js"></script>
    <script src="js/DataStructure/PersonNode.js"></script>
    <script src="js/DataStructure/NodeManager.js"></script>
    <script src="js/script.js"></script>


</body>

</html>